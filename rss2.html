<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>JoelYing</title>
    <link>https://blog.joelyings.com/</link>
    <atom:link href="/rss2.html" rel="self" type="application/rss+xml"/>
    
    <description>半个兴趣使然的程序员</description>
    <pubDate>Sun, 01 Mar 2020 04:54:35 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>asyncio+aiohttp异步爬虫</title>
      <link>https://blog.joelyings.com/post/dbe2f5fc.html</link>
      <guid>https://blog.joelyings.com/post/dbe2f5fc.html</guid>
      <pubDate>Fri, 28 Feb 2020 13:10:13 GMT</pubDate>
      <description>
      
        好好活着，天底下就没有比这更大的道理了
      
      </description>
      
      <content:encoded><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><!-- build time:Sun Mar 01 2020 17:12:42 GMT+0800 (GMT+08:00) --><img class="joel-img" src="http://image.joelyings.com/2020-03-01_1.jpg"><a id="more"></a><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><blockquote><p>进程：进程是一个具有独立功能的程序关于某个数据集合的一次运行活动。进程是操作系统动态执行的基本单元。<br>线程：一个进程中包含若干线程，当然至少有一个线程，线程可以利用进程所拥有的资源。线程是独立运行和独立调度的基本单元。<br>协程：协程是一种用户态的轻量级线程。协程无需线程上下文切换的开销，也无需原子操作锁定及同步的开销。<br>同步：不同程序单元为了完成某个任务，在执行过程中需靠某种通信方式以协调一致，称这些程序单元是同步执行的。<br>异步：为完成某个任务，不同程序单元之间过程中无需通信协调，也能完成任务的方式，不相关的程序单元之间可以是异步的。<br>多进程：多进程就是利用 CPU 的多核优势，在同一时间并行地执行多个任务。多进程模式优点就是稳定性高，因为一个子进程崩溃了，不会影响主进程和其他子进程，但是操作系统能同时运行的进程数是有限的。<br>多线程：多线程模式通常比多进程快一点，但是也快不到哪去，而且，多线程模式致命的缺点就是任何一个线程挂掉都可能直接造成整个进程崩溃，因为所有线程共享进程的内存。</p></blockquote><p>Python 中使用协程最常用的库莫过于<code>asyncio</code>，然后我们还需要了解一些概念：</p><p><code>event_loop 事件循环</code></p><p>程序开启一个无限循环，把一些函数注册到事件循环上，当满足事件发生的时候，调用相应的协程函数</p><p><code>coroutine 协程</code></p><p>协程对象，指一个使用async关键字定义的函数，它的调用不会立即执行函数，而是会返回一个协程对象。协程对象需要注册到事件循环，由事件循环调用。</p><p><code>task 任务</code></p><p>一个协程对象就是一个原生可以挂起的函数，任务则是对协程进一步封装，其中包含了任务的各种状态</p><p><code>future</code></p><p>代表将来执行或没有执行的任务的结果。它和task上没有本质上的区别</p><p><code>async/await 关键字</code></p><p>python3.5用于定义协程的关键字，async定义一个协程，await用于挂起阻塞的异步调用接口。</p><hr><p>不知道为什么我一看概念这些东西，讲的简单点的还好，一长就容易走神…所以这里只是简单复制粘贴了下</p><p><a href="https://docs.python.org/zh-cn/3.6/library/asyncio-eventloop.html" target="_blank" rel="noopener">Python手册中关于asyncio的部分</a><br><a href="https://docs.aiohttp.org/en/stable/client_advanced.html#client-session" target="_blank" rel="noopener">aiohttp手册</a></p><p>很多网上教的例子都在手册上有了，所以直接看手册就行，下面就来根据实例理解理解吧</p><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>这个是我爬取站酷网上<a href="https://www.zcool.com.cn/work/ZMjU4MjMzNDg=.html" target="_blank" rel="noopener">“潇湘过客莫念”的雪中悍刀行的插图</a>，如下所示，通过最基本的<code>requests</code>抓取图片链接，没有遇到反爬</p><p><code>get_content</code>是返回访问图片地址的content数据；<code>downloader</code>是将图片保存到本地的方法；<code>run</code>是提取目标图片链接并循环访问，并且记录整个过程的耗时</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content</span><span class="params">(link)</span>:</span></span><br><span class="line">    r = requests.get(link)</span><br><span class="line">    content = r.content</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">downloader</span><span class="params">(img)</span>:</span></span><br><span class="line">    content = get_content(img[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'D:\\MY\\雪中\\lists2\\'</span> + str(img[<span class="number">0</span>]) + <span class="string">'.jpg'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(content)</span><br><span class="line">    print(<span class="string">'下载成功!'</span> + str(img[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">()</span>:</span></span><br><span class="line">    start = time.time()  <span class="comment"># 记录起始时间戳</span></span><br><span class="line">    base_url = <span class="string">'https://www.zcool.com.cn/work/content/show?p=2&amp;objectId=6455837'</span></span><br><span class="line">    r = requests.get(base_url)</span><br><span class="line">    image_list = r.json()[<span class="string">'data'</span>][<span class="string">'allImageList'</span>]</span><br><span class="line">    <span class="keyword">for</span> i, image <span class="keyword">in</span> enumerate(image_list):</span><br><span class="line">        downloader((i, image[<span class="string">'url'</span>]))</span><br><span class="line">    end = time.time()  <span class="comment"># 获取结束时间戳</span></span><br><span class="line">    print(<span class="string">'共运行了&#123;&#125;秒'</span>.format(end - start))  <span class="comment"># 程序耗时</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    run()</span><br></pre></td></tr></table></figure><p>运行结果：共运行了<code>99.09104537963867</code>秒</p><p>接着我们来看看通过asyncio+aiohttp的方法的异步爬取，同样的，代码分成三个部分（代码在Python3.6环境运行）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">get_content</span><span class="params">(link)</span>:</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">        response = <span class="keyword">await</span> session.get(link)</span><br><span class="line">        content = <span class="keyword">await</span> response.read()</span><br><span class="line">        <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">downloader</span><span class="params">(img)</span>:</span></span><br><span class="line">    content = <span class="keyword">await</span> get_content(img[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'D:\\MY\\雪中\\lists1\\'</span> + str(img[<span class="number">0</span>]) + <span class="string">'.jpg'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(content)</span><br><span class="line">    print(<span class="string">'下载成功!'</span> + str(img[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">()</span>:</span></span><br><span class="line">    start = time.time()  <span class="comment"># 记录起始时间戳</span></span><br><span class="line">    base_url = <span class="string">'https://www.zcool.com.cn/work/content/show?p=2&amp;objectId=6455837'</span></span><br><span class="line">    r = requests.get(base_url)</span><br><span class="line">    image_list = r.json()[<span class="string">'data'</span>][<span class="string">'allImageList'</span>]</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    tasks = [asyncio.ensure_future(downloader((i, image[<span class="string">'url'</span>]))) <span class="keyword">for</span> i, image <span class="keyword">in</span> enumerate(image_list)]</span><br><span class="line">    loop.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">    end = time.time()  <span class="comment"># 获取结束时间戳</span></span><br><span class="line">    print(<span class="string">'共运行了&#123;&#125;秒'</span>.format(end - start))  <span class="comment"># 程序耗时</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    run()</span><br></pre></td></tr></table></figure><p>运行结果：共运行了<code>56.29711127281189</code>秒，跟上面的同步代码比较，节省了一半左右的时间，这里的每张图片大小在几M</p><p>那么我们来看看代码是如何执行的</p><p>这里需要注意的是<code>run</code>方法中增加了<code>loop = asyncio.get_event_loop()</code>，就是创建一个<code>event_loop</code>事件循环，这个事件循环叫<code>loop</code>，然后我们要做的就是把<code>协程</code>放到<code>loop事件循环</code>中，协程对象不能直接运行，在注册事件循环的时候，其实是<code>run_until_complete(coroutine)</code>方法将协程包装成为了一个任务<code>task</code>对象，<code>task</code>对象是<code>Future</code>类的子类，保存了协程运行后的状态，用于未来获取协程的结果</p><p>那么哪来的<code>协程</code>呢？这里以<code>async</code>关键字定义的方法就是一个<code>协程</code>，这个方法在调用时不会立即被执行，而是返回一个协程对象，协程对象需要注册到事件循环，由事件循环调用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasks = [asyncio.ensure_future(downloader((i, image[<span class="string">'url'</span>]))) <span class="keyword">for</span> i, image <span class="keyword">in</span> enumerate(image_list)]</span><br></pre></td></tr></table></figure><p>这行代码的作用实际上就是通过循环生成多个<code>downloader</code>协程，传入一个元组类型的参数，这个元祖中包含两个参数，然后通过<code>asyncio.ensure_future()</code>方法返回<code>task</code>任务(一个协程对象就是一个原生可以挂起的函数，任务则是对协程进一步封装，其中包含了任务的各种状态，通过<code>asyncio.ensure_future(coroutine)</code>创建<code>task</code>,同样的可以通过<code>loop.create_task(coroutine)</code>创建<code>task</code>)，最终得到一个<code>tasks</code>任务列表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loop.run_until_complete(asyncio.wait(tasks))</span><br></pre></td></tr></table></figure><p>而这行代码说实话我没有深入的理解，就大概理解为事件循环执行<code>run_until_complete</code>方法，等到其中的每一个可等待对象都执行完毕，对于其中的每一个对象，去执行<code>downloader协程</code>，运行到<code>await get_content(img[1])</code>时挂起当前的协程，去执行<code>get_content()</code>这个协程，引用了<code>aiohttp</code>里的<code>ClientSession</code>类，建立 了一个<code>session</code>对象，通过<code>session.get()</code>得到<code>response</code>以及最后的<code>content</code>并最终返回<code>content</code></p><p>然后继续执行<code>downloader</code>中的保存图片部分</p><p>以上就是用asyncio+aiohttp的简单的异步爬虫实例，很明显相较于一般的爬虫能节省很多时间啦</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://segmentfault.com/q/1010000021653480?utm_source=tag-newest" target="_blank" rel="noopener">* asyncio.wait如何理解</a><br><a href="https://blog.csdn.net/haeasringnar/article/details/100181793" target="_blank" rel="noopener">asyncio.wait实现的异步</a><br><a href="https://www.cnblogs.com/zhaof/p/8490045.html" target="_blank" rel="noopener">* python中重要的模块–asyncio</a><br><a href="https://www.cnblogs.com/TM0831/p/10274058.html" target="_blank" rel="noopener">* 【Python3爬虫】使用异步协程编写爬虫</a></p><!-- rebuild by neat -->]]></content:encoded>
      
      <comments>https://blog.joelyings.com/post/dbe2f5fc.html#disqus_thread</comments>
    </item>
    
    <item>
      <title>Valine评论邮件提醒</title>
      <link>https://blog.joelyings.com/post/ed7ca194.html</link>
      <guid>https://blog.joelyings.com/post/ed7ca194.html</guid>
      <pubDate>Fri, 07 Feb 2020 12:30:22 GMT</pubDate>
      <description>
      
        我见青山多妩媚，料青山见我应如是
      
      </description>
      
      <content:encoded><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><!-- build time:Sun Mar 01 2020 17:12:42 GMT+0800 (GMT+08:00) --><img class="joel-img" src="http://image.joelyings.com/2020-02-07_1.jpg"><a id="more"></a><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>总是担心有人给博文留言了却不能及时的看到回复，于是想有没有可以一留言就能提醒作者的功能，正好用的是Valine，于是搜索了下，然后在这里记录下Valine评论通过邮件提醒的方法</p><p>Valine官方提供的邮件提醒功能是基于Leancloud的密码重置邮件提醒，可以在<code>你的应用-设置-邮件模板</code>中修改</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><p>参照网上的建议最后决定使用<a href="https://github.com/zhaojun1998/Valine-Admin" target="_blank" rel="noopener">第三方的邮件提醒</a></p><p>当然前提是确保Valine的基础功能是正常的已经能够评论，并且<code>自带的邮件提醒</code>是关闭的</p><figure class="highlight plain"><figcaption><span>themes\next\_config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">valine:</span><br><span class="line">  ...</span><br><span class="line">  notify: false  # 设置notify为false</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure><h3 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h3><p>然后进入<a href="https://leancloud.cn/" target="_blank" rel="noopener">Leancloud</a>对应的Valine应用中</p><p>点击<code>云引擎 -&gt; 设置</code>填写代码库并保存：<code>https://github.com/zhaojun1998/Valine-Admin</code></p><p><img src="http://image.joelyings.com/2020-02-07_2.png" alt></p><p>切换到部署标签页，点击Git源码部署，分支使用 master，点击部署</p><p><img src="http://image.joelyings.com/2020-02-07_3.png" alt></p><p>此外，你需要设置云引擎的环境变量以提供必要的信息，点击云引擎的设置页，设置如下信息</p><p><img src="http://image.joelyings.com/2020-02-07_4.png" alt></p><p>必选参数：</p><ul><li>SITE_NAME : 网站名称</li><li>SITE_URL : 网站地址, 最后不要加 /</li><li>SMTP_USER : SMTP 服务用户名，一般为邮箱地址</li><li>SMTP_PASS : SMTP 密码，一般为授权码，而不是邮箱的登陆密码，请自行查询对应邮件服务商的获取方式</li><li>SMTP_SERVICE : 邮件服务提供商，支持 QQ、163、126、Gmail、”Yahoo”、…… ，全部支持请参考 : <a href="https://nodemailer.com/smtp/well-known/#supported-services" target="_blank" rel="noopener">Nodemailer Supported services</a> — 如这里没有你使用的邮件提供商，请查看<a href="https://github.com/zhaojun1998/Valine-Admin/blob/master/%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE.md#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8" target="_blank" rel="noopener">自定义邮件服务器</a></li><li>SENDER_NAME : 寄件人名称</li></ul><hr><p>若采用企业邮箱，这边的SMTP_SERVICE就不适用了，需要用这三个参数替换：<code>SMTP_HOST</code>、<code>SMTP_PORT</code>、<code>SMTP_SECURE</code></p><ul><li>SMTP_HOST : 邮件服务提供商 SMTP 地址，如 <code>qq : smtp.qq.com</code>，此项需要自行查询或询问其服务商</li><li>SMTP_PORT : 邮件服务提供商 SMTP 端口, 此项需要自行查询或询问其服务商</li><li>SMTP_SECURE : 是否启用加密, 默认为 true，一般不需要设置，如有特殊请自行配置。 此项需要自行查询或询问其服务商。</li></ul><p>可以看到上图中，我的自定义环境变量还多了2个，分别是：</p><ul><li>TO_EMAIL ：这个是填收邮件提醒的邮箱地址，若没有这个字段，则将邮件发到SMTP_USER</li><li>TEMPLATE_NAME：设置提醒邮件的主题，目前内置了两款主题，分别为 default 与 rainbow。默认为 default</li></ul><hr><h3 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h3><p>上面的文档没有介绍怎么获取SMTP授权码，这里说明一下<code>QQ邮箱</code>的：</p><p>进入QQ邮箱，点击上方的<code>设置</code></p><p><img src="http://image.joelyings.com/2020-02-07_6.png" alt></p><p>点击<code>账户</code>选项，往下拉</p><p><img src="http://image.joelyings.com/2020-02-07_7.png" alt></p><p>看到这里的<code>POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务</code>，开启<code>POP3/SMTP服务</code>，然后点击下方的<code>生成授权码</code></p><p><img src="http://image.joelyings.com/2020-02-07_8.png" alt></p><p>这里会要求你用密保手机发短信，然后点<code>我已发送</code>按钮，然后可以看到如下的授权码</p><p><img src="http://image.joelyings.com/2020-02-07_9.png" alt></p><p>复制到<code>SMTP_PASS</code>即可，记得保存</p><h3 id="LeanCloud休眠策略"><a href="#LeanCloud休眠策略" class="headerlink" title="LeanCloud休眠策略"></a>LeanCloud休眠策略</h3><p>配置完这些还要注意，免费版的LeanCloud容器，是有强制性休眠策略的，不能 24 小时运行</p><ul><li>每天必须休眠 6 个小时</li><li>30 分钟内没有外部请求，则休眠</li><li>休眠后如果有新的外部请求实例则马上启动（但激活时此次发送邮件会失败）</li></ul><p>分析了一下上方的策略，如果不想付费的话，最佳使用方案就设置定时器，每天 7 - 23 点每 20 分钟访问一次，这样可以保持每天的绝大多数时间邮件服务是正常的</p><p><strong>方法一</strong></p><p>附 Linux crontab 定时器代码：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/<span class="number">20</span> <span class="number">7</span><span class="number">-23</span> * * * curl https:<span class="comment">//你配置的域名前缀.leanapp.cn</span></span><br></pre></td></tr></table></figure><p><strong>方法二</strong></p><p>首先需要先配置下 Web 主机的域名，使用定时器时要用到，配置方式如下：</p><p><img src="http://image.joelyings.com/2020-02-07_10.png" alt></p><p>后台登录需要账号密码，需要在这里设置，只需要填写 email、password、username，这三个字段即可, 使用 email 作为账号登陆即可。（为了安全考虑，此 email 必须为配置中的 SMTP_USER 或 TO_EMAIL， 否则不允许登录）</p><p><img src="http://image.joelyings.com/2020-02-07_11.png" alt></p><p>事实上我是分配到了一个预备环境的域名，不管了，直接跳到定时任务</p><p>LeanCloud 自带定时器[推荐]</p><p>首先需要添加环境变量，<code>ADMIN_URL：Web 主机域名</code>，如图所示（添加后重启容器才会生效），保存</p><p><img src="http://image.joelyings.com/2020-02-07_12.png" alt></p><p>然后点击<code>云引擎 - 定时任务</code>，创建定时任务，按照图片上填写：</p><p><img src="http://image.joelyings.com/2020-02-07_13.png" alt></p><p>注意, LeanCloud 最近更新了定时器校验规则, 需要将 Cron 表达式写为: <code>0 */20 7-23 * * ?</code></p><p>添加后默认就已启动，启用成功后，每 20 分钟在<code>云引擎的 - 应用日志</code>中可以看到提示</p><p>完成后记得，在<code>云引擎-实例</code>中，重启</p><p><img src="http://image.joelyings.com/2020-02-07_14.png" alt></p><p>等待重启完毕，在你的博文下评论后，你的邮箱就会收到如下的提醒：</p><p><img src="http://image.joelyings.com/2020-02-07_5.png" alt></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://github.com/zhaojun1998/Valine-Admin" target="_blank" rel="noopener">Valine-Admin</a><br><a href="https://www.nhtzj.com/3315416634/#comments" target="_blank" rel="noopener">NexT主题设置Valine评论系统邮件提醒</a><br><a href="https://blog.csdn.net/qq_21808961/article/details/84639401" target="_blank" rel="noopener">hexo next主题 valine评论系统 使用第三方邮件提醒</a></p><!-- rebuild by neat -->]]></content:encoded>
      
      <comments>https://blog.joelyings.com/post/ed7ca194.html#disqus_thread</comments>
    </item>
    
    <item>
      <title>Hexo博客华为云域名解析</title>
      <link>https://blog.joelyings.com/post/8edf7a7d.html</link>
      <guid>https://blog.joelyings.com/post/8edf7a7d.html</guid>
      <pubDate>Fri, 07 Feb 2020 04:32:22 GMT</pubDate>
      <description>
      
        The first rule of Fight Club is you do not talk about Fight Club
      
      </description>
      
      <content:encoded><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><!-- build time:Sun Mar 01 2020 17:12:42 GMT+0800 (GMT+08:00) --><img class="joel-img" src="http://image.joelyings.com/2020-02-07_16.jpg"><a id="more"></a><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>Hexo 绑定个人域名（华为云）</p><h3 id="购买域名"><a href="#购买域名" class="headerlink" title="购买域名"></a>购买域名</h3><p>进入华为云域名注册 <a href="https://www.huaweicloud.com/product/domain.html" target="_blank" rel="noopener">https://www.huaweicloud.com/product/domain.html</a>，搜索自己喜欢的域名</p><p>选择自己喜欢的域名（建议选择常见的，比如说：com，cn，net之类的，考虑到兼容性的问题），然后进行购买</p><p>选择好要购买的期限和域名信息模板（没有的自己建一个，里面的要填写的信息没有特别要讲究的）</p><p>要注意的就是域名购买后，域名信息要实名认证成功后，购买的域名才可以被解析（通俗的说：能被使用）</p><h3 id="绑定域名"><a href="#绑定域名" class="headerlink" title="绑定域名"></a>绑定域名</h3><p>前提是域名到账户上，并且成功实名认证后</p><p>进入华为云控制台，在华为云服务搜索框中搜素 云解析服务 DNS，然后进入。</p><p>一般来说是在公网解析中，在里面可以看到你购买成功的域名，然后点击解析，不用管其它的，直接点击进行设置。填入信息后，确定即可添加成功。</p><table><thead><tr><th align="left">填写目录</th><th align="left">填写信息</th></tr></thead><tbody><tr><td align="left">主机记录</td><td align="left">旁边有个问号，里面有详解，我是直接填了<code>www</code></td></tr><tr><td align="left">类型</td><td align="left">普通的只需要A、CNAME（详情的可以看后面的跟的说明），我选择的是<code>CNAME</code></td></tr><tr><td align="left">别名</td><td align="left">不用管，没用到，选<code>否</code></td></tr><tr><td align="left">线路类型</td><td align="left">普通的<code>全网默认</code>就行了</td></tr><tr><td align="left">TTL</td><td align="left">默认，<code>5分钟</code></td></tr><tr><td align="left">值</td><td align="left">CNAME： 填写需要绑定的域名（例：genmcai.github.io） A： 填写需要绑定的IP（查看方法放下面）</td></tr><tr><td align="left">权重</td><td align="left">可选参数，解析记录的权重，可选参数，默认值为1。取值范围：0~100。当域名有多条某一类型的解析记录时，根据权重数值选择解析记录，权重数值越高，优先级越高</td></tr></tbody></table><p>IP查看方法</p><p>Ctrl+R 进入 运行 输入 cmd ，输入命令 Ping 域名(例：Ping genmcai.github.io)</p><p>下面出现的IPv4地址即是 A 所需的值</p><p>进入github，到存放网站的仓库，<code>Settings -&gt; Options -&gt; GitHub Pages -&gt; Custom domain -&gt; 填写需要绑定的个人域名</code> 点击save后，网站上会提示是否成功</p><h3 id="最后一步"><a href="#最后一步" class="headerlink" title="最后一步"></a>最后一步</h3><p>在hexo的根目录下source 中添加一个无后缀名的文件（文件名：CNAME），里面内容填写你绑定的域名</p><p>至于有些同学会问怎么写入，这个可以直接先txt填入内容后删掉后缀名，或者用VS code之类的打开无后缀名的文件，也能写入</p><p>这一步可以说挺重要的，如果没有这个文件，<code>hexo g -d</code>提交后，页面就会变成404，这个时候重复第3个步骤就能恢复，不过每次都这样很麻烦，而且可能会清空博客访问记录</p><p>至此，个人域名的绑定就结束了，重新使用自己的个人域名进行访问，就能访问到绑定的hexo了。如果出现错误，有可能是主题版本的原因，也有可能是其他的原因</p><h2 id="两端部署"><a href="#两端部署" class="headerlink" title="两端部署"></a>两端部署</h2><p>原本博客是在github的，访问<a href="https://joelying.github.io/" target="_blank" rel="noopener">https://joelying.github.io/</a>即可进入，后来用华为云的域名<code>blog.joelyings.com</code>解析<code>joelying.github.io</code>，就可以通过访问<code>blog.joeyings.com</code>进入博客</p><p>如果只想部署在coding上的hexo项目通过域名访问，可以解除了<code>GitHub Pages -&gt; Custom domain</code>中绑定的<code>blog.joelyings.com</code>，也就是现在可以访问原来的<a href="https://joelying.github.io/" target="_blank" rel="noopener">https://joelying.github.io/</a>（github）</p><p>然后在coding的hexo项目的静态网站中设置要绑定的域名（华为云）</p><p>在华为云域名解析设置中添加<code>CNAME</code>记录指向<code>xxx.coding-pages.com</code></p><p>当显示的已绑定域名<code>blog.joelyings.com</code>的证书状态为<code>正常</code>时，就可以成功访问<code>blog.joelyings.com</code></p><p>即现在可以访问<a href="blog.joelyings.com">blog.joelyings.com</a>（coding）</p><hr><p>当然要想两端都部署，然后通过一个域名访问的话：</p><ol><li><p>要在github的<code>xxx.github,io</code>的项目settings中的<code>Options -&gt; GitHub Pages -&gt; Custom domain</code>处添加你的域名，并确保在（华为云）域名解析处有指向<code>xxx.github,io</code>的CNAME解析，在<code>Custom domain</code>处看到<code>Your site is ready to be published at https://xxx.xxx.com</code>就成功</p></li><li><p>在coding的项目的静态网站（默认没有静态网站的可以去项目设置的功能开关中打开构建与部署）设置中，添加绑带域名，也确保华为云域名解析设置中添加<code>CNAME</code>记录指向<code>xxx.coding-pages.com</code></p></li></ol><h2 id="SEO优化"><a href="#SEO优化" class="headerlink" title="SEO优化"></a>SEO优化</h2><h3 id="收录"><a href="#收录" class="headerlink" title="收录"></a>收录</h3><p>先到<a href="https://ziyuan.baidu.com/site/siteadd#/" target="_blank" rel="noopener">这里</a>，登录账号之后：右上角用户中心 -&gt; 然后左侧站点管理 -&gt; 添加网站</p><p>选择<code>https</code>协议头，输入你要添加的网站，选择站点属性，再来到验证网站</p><p>这里选择CNAME验证，将<code>xxx.你提交的网站域名</code>使用CNAME解析到<code>ziyuan.baidu.com</code></p><p>完成后点击<code>完成验证</code>按钮</p><p>为保持验证通过的状态，成功验证后请不要删除该DNS记录，然后等待一会，验证通过即收录网站成功</p><h3 id="sitemap"><a href="#sitemap" class="headerlink" title="sitemap"></a>sitemap</h3><p>先安装生成sitemap的插件，在站点的根目录下执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><div class="note warning"><p>不用安装hexo-generator-baidu-sitemap，有的教程会告诉你，这个是专门针对百度的sitemap，其实根本不是。这个插件本身最开始只是为了本地搜索做的，用的时候，如果标题里面带有&这种本身有预定义的符号，后续提交的时候会出现解析出错，所以不用安装。</p></div><p>安装好了之后，再生成一次网页，也就是执行一次<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></p><p>然后会在<code>/yoursite/public/</code>下面看到<code>sitemap.xml</code>文件</p><h3 id="提交sitemap"><a href="#提交sitemap" class="headerlink" title="提交sitemap"></a>提交sitemap</h3><p>打开百度站长平台，进入你刚刚添加的站点</p><p>先点击左侧链接提交，然后点击sitemap</p><p>填入<code>你的站点名称/sitemap.xml</code>，或者你有自己的域名，只是在coding上托管代码，就填入<code>域名/sitemap.xml</code>，如果不确定的话，可以先把这个链接<strong>在浏览器中打开试试</strong></p><p>如果看不到xml页面，请检查你的站点配置文件中的<code>url</code>是否改成了你的域名</p><figure class="highlight plain"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># URL</span><br><span class="line">## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;</span><br><span class="line">url: https://blog.joelyings.com</span><br><span class="line">root: /</span><br><span class="line">permalink: :year/:month/:day/:title/</span><br><span class="line">permalink_defaults:</span><br></pre></td></tr></table></figure><p>然后提交上去，下面会有结果，刷新之后会显示状态正常，后面还有提取的链接数量（可能很久，且注意github端也部署的话会导致百度抓取超时而发生错误，所以最后我把网站只部署在Coding）</p><p>sitemap会定期自动更新，如果添加了新页面，想快速收录的话，可以手动更新文件</p><div class="note info"><p>site:blog.joelyings.com 可以看你的网站是否被收录了</p></div><h3 id="自动推送"><a href="#自动推送" class="headerlink" title="自动推送"></a>自动推送</h3><p>自动退送的话，Hexo框架已经给我们集成好了，只需要修改主题配置文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">baidu_push:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>将这个改成true，在你每次执行hexo d的时候就会自动推送到百度</p><h3 id="添加蜘蛛协议"><a href="#添加蜘蛛协议" class="headerlink" title="添加蜘蛛协议"></a>添加蜘蛛协议</h3><p>蜘蛛协议就是告诉爬虫，你的哪些文件爬虫可以爬取，哪些不能的文件</p><p>新建一个robots.txt文件，添加以下内容，然后放到/yoursite/source/文件夹下面：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-agent</span>: *</span><br><span class="line"><span class="attribute">Allow</span>: /</span><br><span class="line"><span class="attribute">Allow</span>: /archives/</span><br><span class="line"><span class="attribute">Allow</span>: /tags/</span><br><span class="line"><span class="attribute">Allow</span>: /categories/</span><br><span class="line"><span class="attribute">Allow</span>: /about/</span><br><span class="line"></span><br><span class="line"><span class="attribute">Disallow</span>: /js/</span><br><span class="line"><span class="attribute">Disallow</span>: /css/</span><br><span class="line"><span class="attribute">Disallow</span>: /lib/</span><br><span class="line"></span><br><span class="line"><span class="attribute">Sitemap</span>: 刚刚sitemap的地址</span><br></pre></td></tr></table></figure><p>执行<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code>，就同步到了coding上了</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.genmcai.com/2019/08/03/hexo_DomainName/" target="_blank" rel="noopener">Hexo 绑定个人域名（华为云版）</a><br><a href="https://segmentfault.com/q/1010000004557073" target="_blank" rel="noopener">个人域名如何同时绑定 github 和 coding 上的博客</a><br><a href="http://dugblog.coding.me/Hexo/20180625-Hexo-SEO.html" target="_blank" rel="noopener">Hexo个人博客SEO优化——如何被百度谷歌收录</a><br><a href="https://www.jianshu.com/p/7103fbbe1eba" target="_blank" rel="noopener">同时托管博客到github和coding</a></p><!-- rebuild by neat -->]]></content:encoded>
      
      <comments>https://blog.joelyings.com/post/8edf7a7d.html#disqus_thread</comments>
    </item>
    
    <item>
      <title>Django搭建免费视频网站其三</title>
      <link>https://blog.joelyings.com/post/f3026717.html</link>
      <guid>https://blog.joelyings.com/post/f3026717.html</guid>
      <pubDate>Thu, 06 Feb 2020 08:04:20 GMT</pubDate>
      <description>
      
        情，心中青梅，年老仍记年少涩
      
      </description>
      
      <content:encoded><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><!-- build time:Sun Mar 01 2020 17:12:42 GMT+0800 (GMT+08:00) --><img class="joel-img" src="http://image.joelyings.com/2020-02-06_8.jpg"><a id="more"></a><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p><a href="https://github.com/joelYing/LVideo" target="_blank" rel="noopener">代码传送门</a></p><h3 id="登录注册功能"><a href="#登录注册功能" class="headerlink" title="登录注册功能"></a>登录注册功能</h3><p>在base.html中挖个block：</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">block</span></span> login-register %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure><p>在需要的页面上填补</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block login-register %&#125;</span><br><span class="line">    &#123;% if request.session.is_login %&#125;</span><br><span class="line">        &#123;% include "video/user_model.html" %&#125;</span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">        &#123;% include "video/model.html" %&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>包含登录注册的按钮</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav navbar-right"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span> <span class="attr">id</span>=<span class="string">"register-btn"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">data-toggle</span>=<span class="string">"modal"</span> <span class="attr">data-target</span>=<span class="string">"#register"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>&amp;nbsp;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span> <span class="attr">id</span>=<span class="string">"login-btn"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">data-toggle</span>=<span class="string">"modal"</span> <span class="attr">data-target</span>=<span class="string">"#login"</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注册窗口 --&gt;</span></span><br><span class="line">&#123;% include 'video/register.html' %&#125;</span><br><span class="line"><span class="comment">&lt;!-- 登录窗口 --&gt;</span></span><br><span class="line">&#123;% include 'video/login.html' %&#125;</span><br></pre></td></tr></table></figure><p>登录注册，我采用的是bootstrap的模态框modal</p><p>登录部分：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"login"</span> <span class="attr">class</span>=<span class="string">"modal fade"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content l-register-login"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"close l-register-login"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-title"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span><br><span class="line">                # 模态框的主体form部分</span><br><span class="line">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-group"</span> <span class="attr">id</span>=<span class="string">"loginform"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                    &#123;% csrf_token %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"l-username"</span> <span class="attr">placeholder</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-left"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"alert-warning"</span> <span class="attr">id</span>=<span class="string">"login-info"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"loginbtn"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">data-toggle</span>=<span class="string">"modal"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">data-target</span>=<span class="string">"#register"</span>&gt;</span>还没有账号？点我注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line">                &#123;#const token = $('input[name=csrfmiddlewaretoken]').val();#&#125;</span><br><span class="line"><span class="javascript">                $(<span class="string">"#loginbtn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    $.ajax(&#123;</span></span><br><span class="line">                        &#123;#cache:false,#&#125;</span><br><span class="line"><span class="actionscript">                        type:<span class="string">"POST"</span>,</span></span><br><span class="line"><span class="actionscript">                        url:<span class="string">"/login"</span>,</span></span><br><span class="line"><span class="actionscript">                        dataType:<span class="string">'json'</span>,</span></span><br><span class="line">                        data:&#123;</span><br><span class="line"><span class="actionscript">                            <span class="string">"csrfmiddlewaretoken"</span>: <span class="string">'&#123;&#123; csrf_token &#125;&#125;'</span>,</span></span><br><span class="line"><span class="javascript">                            <span class="string">"username"</span>: $(<span class="string">"#l-username"</span>).val(),</span></span><br><span class="line"><span class="javascript">                            <span class="string">"password"</span>: $(<span class="string">"#password"</span>).val(),</span></span><br><span class="line">                        &#125;,</span><br><span class="line"><span class="actionscript">                        <span class="comment">//通过id找到提交form表单，并将表单转成字符串</span></span></span><br><span class="line"><span class="javascript">                        <span class="keyword">async</span>:<span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">                        <span class="comment">//异步为真，ajax提交的过程中，同时可以做其他的操作</span></span></span><br><span class="line"><span class="actionscript">                        success:<span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                            <span class="comment">//jquery3以后，会将回传过来的字符串格式的data自动json解析不用再使用一遍JSON.parse(data)了，不然反而会在控制台报错</span></span></span><br><span class="line"><span class="actionscript">                            <span class="keyword">if</span>(data.status===<span class="string">"success"</span>) &#123;</span></span><br><span class="line">                                &#123;#$("#login-info").text(data.msg);#&#125;</span><br><span class="line">                                &#123;#$('#login').modal('hide');#&#125;</span><br><span class="line"><span class="javascript">                                <span class="built_in">window</span>.location.reload();</span></span><br><span class="line">                            &#125;</span><br><span class="line"><span class="actionscript">                            <span class="keyword">else</span> <span class="keyword">if</span>(data.status===<span class="string">"fail"</span>)&#123;</span></span><br><span class="line"><span class="javascript">                                $(<span class="string">'#login-info'</span>).text(data.msg);</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            &#123;#console.log(data);#&#125;</span><br><span class="line">                            &#123;#console.log(data.status);#&#125;</span><br><span class="line">                            &#123;#console.log(data.message);#&#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line"><span class="actionscript">                <span class="comment">//如果显示了错误信息，修改输入框内容，错误信息隐藏</span></span></span><br><span class="line"><span class="javascript">                $(<span class="string">"input"</span>).bind(<span class="string">'input propertychange'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    $(<span class="string">'#login-info'</span>).html(<span class="string">''</span>);</span></span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>登录部分逻辑：</p><p>通过ajax提交登录的用户名以及密码，视图层对接收到的用户名密码进行校验，若成功则返回登录成功的信息，并设置session，传回来的信息若成功则会刷新当前页面，同时判断session中<code>is_login</code>是否为True，若为True，则登录注册按钮替换为用户名和注销按钮</p><p>注意点：</p><p>通过ajax给弹出来的模态框中的登录提交按钮添加点击事件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    type:<span class="string">"POST"</span>,           <span class="comment">// 请求类型</span></span><br><span class="line">    url:<span class="string">"/login"</span>,          <span class="comment">// 请求的路径</span></span><br><span class="line">    dataType:<span class="string">'json'</span>,       <span class="comment">// 数据格式</span></span><br><span class="line">    data:&#123;</span><br><span class="line">        <span class="string">"csrfmiddlewaretoken"</span>: <span class="string">'&#123;&#123; csrf_token &#125;&#125;'</span>,  <span class="comment">// 避免提交时Forbidden (CSRF token missing or incorrect.)</span></span><br><span class="line">        <span class="string">"username"</span>: $(<span class="string">"#l-username"</span>).val(),         <span class="comment">// 注意取值时用 val()</span></span><br><span class="line">        <span class="string">"password"</span>: $(<span class="string">"#password"</span>).val(),</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span>:<span class="literal">true</span>,                                     <span class="comment">// 异步为真，ajax提交的过程中，同时可以做其他的操作</span></span><br><span class="line">    success:<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//jquery3以后，会将回传过来的字符串格式的data自动json解析不用再使用一遍JSON.parse(data)了，不然反而会在控制台报错</span></span><br><span class="line">        <span class="keyword">if</span>(data.status===<span class="string">"success"</span>) &#123;</span><br><span class="line">            <span class="built_in">window</span>.location.reload();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(data.status===<span class="string">"fail"</span>)&#123;              <span class="comment">// 若返回的信息中 status为fail ，则打印msg</span></span><br><span class="line">            $(<span class="string">'#login-info'</span>).text(data.msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>登录部分视图层逻辑：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span> <span class="keyword">and</span> request.POST:</span><br><span class="line">        data = request.POST</span><br><span class="line">        username = data.get(<span class="string">"username"</span>)</span><br><span class="line">        password = data.get(<span class="string">"password"</span>)</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">and</span> password:</span><br><span class="line">            custom = Custom.objects.filter(username=username).first()</span><br><span class="line">            <span class="keyword">if</span> custom:</span><br><span class="line">                now_password = Custom.md5_pwd(password)</span><br><span class="line">                db_password = custom.password</span><br><span class="line">                <span class="keyword">if</span> now_password == db_password:</span><br><span class="line">                    response = JsonResponse(&#123;<span class="string">"status"</span>: <span class="string">"success"</span>, <span class="string">"msg"</span>: <span class="string">"登录成功"</span>&#125;)</span><br><span class="line">                    <span class="comment"># response.set_cookie('username', username, max_age=7 * 24 * 3600)</span></span><br><span class="line">                    <span class="comment"># response.set_cookie('password', password, max_age=7 * 24 * 3600)</span></span><br><span class="line">                    <span class="comment"># 通过session识别用户并保持用户状态</span></span><br><span class="line">                    request.session[<span class="string">'is_login'</span>] = <span class="literal">True</span></span><br><span class="line">                    request.session[<span class="string">'username'</span>] = username</span><br><span class="line">                    <span class="keyword">return</span> response</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "密码错误"&#125;'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "用户不存在"&#125;'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "用户名或密码为空"&#125;'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "请求失败"&#125;'</span>)</span><br></pre></td></tr></table></figure><p>注意HttpResponse与JsonResponse使用时的差别！！！</p><p>登陆成功后刷新页面过程会判断session.is_login，若是True，就显示<code>video/user_model.html</code>中的用户名及注销按钮：</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">block</span></span> login-register %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">    </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> request.session.is_login %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;% <span class="name"><span class="name">include</span></span> "video/user_model.html" %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">    </span><span class="template-tag">&#123;% <span class="name"><span class="name">else</span></span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;% <span class="name"><span class="name">include</span></span> "video/model.html" %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">    </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">endblock</span></span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure><p>注册视图层逻辑：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"POST"</span> <span class="keyword">and</span> request.POST:</span><br><span class="line">        data = request.POST</span><br><span class="line">        username = data.get(<span class="string">"username"</span>)</span><br><span class="line">        email = data.get(<span class="string">"email"</span>)</span><br><span class="line">        password1 = data.get(<span class="string">"password1"</span>)</span><br><span class="line">        password2 = data.get(<span class="string">"password2"</span>)</span><br><span class="line">        custom = Custom.objects.filter(username=username)</span><br><span class="line">        custom_email = Custom.objects.filter(email=email)</span><br><span class="line">        <span class="keyword">if</span> custom:</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "用户名已存在，请重新输入"&#125;'</span>)</span><br><span class="line">        <span class="keyword">if</span> password1 != password2:</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "亲~两次密码输入不一致，请重新输入"&#125;'</span>)</span><br><span class="line">        <span class="keyword">if</span> custom_email:  <span class="comment"># 邮箱地址唯一</span></span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "该邮箱已注册，请换一个邮箱"&#125;'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 注册成功，创建用户</span></span><br><span class="line">            Custom.objects.create(</span><br><span class="line">                username=username,</span><br><span class="line">                email=email,</span><br><span class="line">                password=Custom.md5_pwd(password1),</span><br><span class="line">            )</span><br><span class="line">            <span class="comment"># 重定向到登录页面</span></span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "success", "msg": "注册成功"&#125;'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">'&#123;"status": "fail", "msg": "请求失败"&#125;'</span>)</span><br></pre></td></tr></table></figure><p>注销视图层逻辑：</p><p>点击注销按钮，如果拿到<code>is_login</code>的值为True，那么刷新session，清除了用户的登录状态，然后重定向回index页面，重定向过程判断<code>is_login</code>值不存在，就会显示登录注册的按钮</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.session.get(<span class="string">'is_login'</span>):</span><br><span class="line">        request.session.flush()</span><br><span class="line">        <span class="comment"># flush会一次性清空session中所有内容，可以使用下面的方法</span></span><br><span class="line">        <span class="comment"># del request.session['is_login']</span></span><br><span class="line">        <span class="comment"># del request.session['user_id']</span></span><br><span class="line">        <span class="comment"># del request.session['user_name']</span></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">"index"</span>)</span><br></pre></td></tr></table></figure><h3 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h3><p>ajax传的数据格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data:&#123;</span><br><span class="line">    <span class="string">"name"</span>: $(<span class="string">"#id_name"</span>).val(),      <span class="comment">// 在"#"号后面是控件id， 所以千万不要搞错了，要不然会出大事的</span></span><br><span class="line">    <span class="string">"limit"</span>: $(<span class="string">"#id_limit"</span>).val(),</span><br><span class="line">    <span class="string">"address"</span>: $(<span class="string">"#id_address"</span>).val(),</span><br><span class="line">    <span class="string">"start_time"</span>: $(<span class="string">"#id_start_time"</span>).val(),</span><br><span class="line">    <span class="string">"status"</span>: $(<span class="string">"#id_status"</span>).val(),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>view层返回到ajax的数据应该如以下类型：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">+ return HttpResponse('&#123;"status": "success", "msg": "登录成功"&#125;')</span></span><br></pre></td></tr></table></figure><p>而不是</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- return HttpResponse('&#123;"status": "success"&#125;, &#123;"msg": "登录成功"&#125;')</span></span><br></pre></td></tr></table></figure><p>ajax实现发送post请求到服务器并返回结果信息到HTML页面主要逻辑参考：<br><a href="https://cloud.tencent.com/developer/article/1145518" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1145518</a><br><a href="https://blog.csdn.net/Jayden_Gu/article/details/82386565" target="_blank" rel="noopener">https://blog.csdn.net/Jayden_Gu/article/details/82386565</a></p><p>用ajax实现点击登录弹出对话框登陆，成功后页面不刷新，修改登录为用户名：</p><p><a href="https://www.cnblogs.com/chenxi188/p/12176700.html" target="_blank" rel="noopener">Cookie版参考</a></p><p>ajax发送请求后，在views中，若成功登录的条件符合，接下来就添加给response添加set_cookie为username，这样一来request中就保留了cookie的信息，而再通过判断取得cookie中的username，若为空则用户未登录，若有值则将这个值传入模板中渲染即可</p><p><a href="https://www.jianshu.com/p/4f84d0e0c8c9" target="_blank" rel="noopener">session版参考</a></p><p>解决注销，session保持会话状态的问题，Django的模板中可以直接引用request.session</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/weixin_44239541/article/details/89055637" target="_blank" rel="noopener">基础功能逻辑</a><br><a href="https://blog.csdn.net/u012561176/article/details/84552532" target="_blank" rel="noopener">表单提交</a><br><a href="https://blog.csdn.net/qq_26421325/article/details/44153039" target="_blank" rel="noopener">消息提示</a><br><a href="https://blog.csdn.net/miaoqinian/article/details/80668003" target="_blank" rel="noopener">HttpResponse、render,、redirect</a><br><a href="https://www.jianshu.com/p/4ffd7184b611" target="_blank" rel="noopener">注册登录弹出模态框</a><br><a href="https://www.cnblogs.com/iqian/p/5784972.html" target="_blank" rel="noopener">ajax格式</a></p><!-- rebuild by neat -->]]></content:encoded>
      
      <comments>https://blog.joelyings.com/post/f3026717.html#disqus_thread</comments>
    </item>
    
    <item>
      <title>Pyqt5实现一个小项目的界面</title>
      <link>https://blog.joelyings.com/post/8d24b1e6.html</link>
      <guid>https://blog.joelyings.com/post/8d24b1e6.html</guid>
      <pubDate>Wed, 05 Feb 2020 14:28:46 GMT</pubDate>
      <description>
      
        天上剑仙三百万，遇我也需尽低眉
      
      </description>
      
      <content:encoded><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><!-- build time:Sun Mar 01 2020 17:12:42 GMT+0800 (GMT+08:00) --><img class="joel-img" src="http://image.joelyings.com/2020-02-06_3.jpg"><a id="more"></a><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装Pyqt5</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pyqt5 -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><p>安装Qtcreator，<a href="http://download.qt.io/official_releases/qtcreator/" target="_blank" rel="noopener">地址</a></p><h2 id="制作"><a href="#制作" class="headerlink" title="制作"></a>制作</h2><p>新建参考：<a href="https://www.jianshu.com/p/3be3bfcdd62e" target="_blank" rel="noopener">https://www.jianshu.com/p/3be3bfcdd62e</a></p><p>结果</p><p><img src="http://image.joelyings.com/2020-02-06_1.png" alt></p><h2 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h2><p>将.ui的文件转换为.py的文件，cmd命令进入.ui文件所在目录下，运行以下命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyuic5 -o xxx.py xxx.ui</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/weixin_41929524/article/details/81456308" target="_blank" rel="noopener">Python制作小软件——1. 安装并使用PyQt5进行界面设计</a><br><a href="https://www.cnblogs.com/chen0307/p/9844352.html" target="_blank" rel="noopener">python使用PyQt5，及QtCreator，qt-unified界面设计以及逻辑实现</a><br><a href="https://www.cnblogs.com/linyfeng/category/1546338.html" target="_blank" rel="noopener">随笔分类 - PyQt入门教程</a><br><a href="https://blog.csdn.net/weixin_41929524/article/details/81484806" target="_blank" rel="noopener">Python制作小软件——4. 利用PyInstaller打包成exe文件</a><br><a href="https://blog.csdn.net/bailang_zhizun/article/details/79310419" target="_blank" rel="noopener">Python - 编写可视化界面（Python+PyCharm+PyQt）</a><br><a href></a></p><!-- rebuild by neat -->]]></content:encoded>
      
      <comments>https://blog.joelyings.com/post/8d24b1e6.html#disqus_thread</comments>
    </item>
    
  </channel>
</rss>
